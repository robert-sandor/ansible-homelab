---
- name: Create backup directory
  ansible.builtin.file:
    state: directory
    path: "{{ backup_path }}/paperless"
    mode: "0750"

- name: Template backup.sh
  ansible.builtin.template:
    src: backup.sh
    dest: "{{ paperless_deploy_path }}/backup.sh"
    mode: "0750"

- name: Create crontab entry for backup.sh
  ansible.builtin.cron:
    state: present
    name: paperless_backup
    user: "{{ ansible_facts.user_id }}"
    job: "{{ paperless_deploy_path }}/backup.sh"
    hour: 3
